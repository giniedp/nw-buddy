<ion-header>
  <ion-toolbar class="ion-color ion-color-black rounded-t-md">
    <ion-title>{{ title() }}</ion-title>
    <div slot="primary" class="join">
      @if (service.canToggleMode()) {
        <button class="join-item btn btn-square btn-ghost" [nwbDataViewToggle]></button>
      }
      @if (service.isTableSupported() || service.isTableActive()) {
        <button
          class="join-item btn btn-square btn-ghost"
          [nwbDataViewOptionsMenu]
          [disabled]="!service.isTableActive()"
        ></button>
      }
    </div>
    <div slot="end" class="flex flex-row items-center">
      @if (categories()?.length) {
        <select class="select select-sm mr-1 w-36" [ngModel]="category()" (ngModelChange)="service.loadCategory($event)">
          <option [ngValue]="null">All</option>
          @for (category of categories(); track category.id) {
            <option [value]="category.id">{{ category.label }}</option>
          }
        </select>
      }
      <nwb-quicksearch-input [autofocus]="true" class="mr-1  w-36" />
    </div>
  </ion-toolbar>
</ion-header>
<ion-content class="bg-base-200">
  @if (service.isGridActive()) {
    <nwb-virtual-grid
      [enableQuickfilter]="true"
      [selection]="selection()"
      [data]="service.categoryItems()"
      [options]="service.virtualOptions"
      [identifyBy]="service.entityIdGetter"
      (selection$)="onSelectionChange($event)"
      (cellDoubleClicked)="commit()"
    />
  } @else if (service.isTableActive()) {
    <nwb-table-grid
      (ready$)="service.onTableReady($event)"
      [enableQuickfilter]="true"
      [selection]="selection()"
      [data]="service.categoryItems()"
      [options]="service.tableGridOptions"
      [identifyBy]="service.entityIdGetter"
      [persistKey]="persistKey()"
      (selectionChanged$)="onSelectionChange($event.ids)"
      (rowDoubleClicked$)="commit()"
    />
  }
</ion-content>
<ion-footer class="rounded-b-md">
  <ion-toolbar class="ion-color ion-color-base-300">
    <div class="join px-1 w-full sm:w-auto" slot="end">
      <button class="join-item flex-1 btn btn-ghost sm:min-w-28" (click)="close()">Cancel</button>
      <button class="join-item flex-1 btn btn-ghost sm:min-w-28" (click)="clear()">Clear selection</button>
      <button class="join-item flex-1 btn btn-ghost text-primary sm:min-w-28" (click)="commit()">OK</button>
    </div>
  </ion-toolbar>
</ion-footer>
