<h3 class="uppercase relative text-center font-serif text-nw-description px-2 py-1 nw-bg-title bg-bottom">
  <span>{{ title | nwText }}</span>
</h3>
<div class="px-2 py-1">
  <div class="mx-auto grid grid-cols-[1fr_auto_auto_auto] gap-1 items-center max-w-full">
    @for (row of source; track $index) {
      <nwb-modifier-source-label [data]="row.source" />
      <div class="font-mono font-thin">
        {{ rowSign(row) }}
      </div>
      <div class="font-mono font-thin text-right" [class.text-primary]="row['capped']">
        @if (percent) {
          {{ rowValue(row) | percent: format }}
        } @else {
          {{ rowValue(row) | number: format }}
        }
      </div>
      <div class="overflow-clip flex flex-row flex-nowrap gap-1">
        @if (row['category']; as category) {
          <span class="flex-none text-xs italic opacity-50"> cap at {{ row['limit'] | percent: '0.1-1' }} </span>
          <span class="badge badge-secondary badge-xs whitespace-nowrap overflow-hidden text-ellipsis justify-start bg-secondary/50">
            {{ category }}
          </span>
        }
      </div>
    }
    @if (showSum) {
      <div></div>
      <div class="col-span-2 font-mono font-thin text-right border-double border-t-4 flex flex-col">
        <span [class.line-through]="isOvershoot" [class.opacity-50]="isOvershoot">
          @if (percent) {
            {{ sumValue | percent: format }}
          } @else {
            {{ sumValue | number: format }}
          }
        </span>
        @if (isOvershoot) {
          <span class="text-danger">
            @if (percent) {
              {{ value | percent: format }}
            } @else {
              {{ value | number: format }}
            }
          </span>
        }
      </div>
      <div></div>
    }
  </div>
  <div class="text-sm flex flex-col text-center">
    @if (isOvershoot) {
      <div>
        Overshoot by
        <span class="text-error">
          @if (percent) {
            {{ sumValue - value | percent: '0.0-3' }}
          } @else {
            {{ sumValue - value | number: '0.0-3' }}
          }
        </span>
      </div>
    }
  </div>
</div>
